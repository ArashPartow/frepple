<div>
    <table class="table table-bordered table-fixed weekview-header">
        <thead>
        <tr>
            <th data-ng-if="grouping && groupingdir !== 'desc'" class="calendar-sort-column" data-ng-click="setGroupingDir('desc')">
              {{groupingcfg[grouping]}}&nbsp;<i class="fa fa-sort-asc"></i>
            </th>
            <th data-ng-if="grouping && groupingdir === 'desc'" class="calendar-sort-column" data-ng-click="setGroupingDir('asc')">
              {{groupingcfg[grouping]}}&nbsp;<i class="fa fa-sort-desc"></i>
            </th>
            <th data-ng-if="calendarmode == 'duration'" class="calendar-hour-column"></th>
            <th ng-repeat="dt in dates" class="text-center weekview-header-label">{{dt.date| date:formatWeekViewDayHeader}}</th>
            <th class="gutter-column" ng-style="{width: scrollBarWidth+'px'}"></th>
        </tr>
        </thead>
    </table>
    <div id="scrollweekview" class="scrollable" data-ng-style="{'height': getHeight(60)}">
        <table class="table table-bordered table-fixed" data-ng-switch="calendarmode">
            <tbody data-ng-switch-when="duration" data-ng-repeat="cat in categories track by cat"> 
            <tr data-ng-repeat="row in rows track by $index">
                <td data-ng-if="grouping && $index == 0" rowspan="{{ rows.length }}">{{cat}}</td>
                <td class="calendar-hour-column text-center">
                    {{row[0].date | date: formatHourColumn}}
                </td>
                <td data-ng-repeat="dt in row track by dt.date" class="calendar-cell">
                    <div data-ng-class="{'calendar-event-wrap': dt.events}" ng-if="dt.events">
                        <div data-ng-repeat="opplan in dt.events" class="calendar-event weekcard" data-ng-click="selectCard(opplan.event)"        
                             data-ng-style="{top: (37*opplan.startOffset/hourParts)+'px',left: 100/opplan.overlapNumber*opplan.position+'%', width: 100/opplan.overlapNumber+'%', height: 37*(opplan.endIndex -opplan.startIndex - (opplan.endOffset + opplan.startOffset)/hourParts)+'px'}"
                             data-ng-if="!grouping || opplan.event[grouping] == cat">
                           <ng-include src="'/input/card.html'"/>
                        </div>
                    </div>
                </td>
            </tr>
            </tbody>
            <tbody data-ng-switch-default>
              <tr data-ng-repeat="cat in categories track by cat">
              <td data-ng-if="grouping">{{cat}}</td>
              <td data-ng-repeat="dt in dates track by dt.date">
                  <div data-ng-repeat="opplan in dt.events" class="card-month" data-ng-click="selectCard(opplan)"        
                     data-ng-if="(!grouping || opplan[grouping] == cat) && displayEvent(opplan, dt)">
                     <ng-include src="'/input/card.html'"/>
                  </div>
              </td>
              </tr>
            </tbody>
        </table>
    </div>
</div>